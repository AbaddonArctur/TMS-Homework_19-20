{% extends "base.html" %}

{% block title %}–ì–ª–∞–≤–Ω–∞—è ‚Äî –†–µ—Ü–µ–ø—Ç—ã{% endblock %}

{% block content %}
<h2>–í—Å–µ —Ä–µ—Ü–µ–ø—Ç—ã</h2>

<form class="d-flex mb-4" action="{{ url_for('main.index') }}" method="get">
    <input class="form-control me-2" type="search" name="q" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–ª–∏ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞–º" value="{{ query if query else '' }}">
    <button class="btn btn-outline-success" type="submit">–ü–æ–∏—Å–∫</button>
    {% if q %}
        <a href="{{ url_for('main.index') }}" class="btn btn-outline-secondary">–û—á–∏—Å—Ç–∏—Ç—å</a>
    {% endif %}
</form>

{% if recipes %}
    <div class="row">
        {% for recipe in recipes %}
            <div class="col-md-4 mb-4">
                <div class="card h-100 shadow-sm">
                    {% if recipe.image_filename %}
                        <img src="{{ url_for('static', filename='uploads/' + recipe.image_filename) }}"
                             class="card-img-top"
                             alt="{{ recipe.title }}">
                    {% else %}
                        <div class="card-img-top no-image">–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</div>
                    {% endif %}
                    <div class="card-body">
                        <h5 class="card-title">{{ recipe.title }}</h5>
                        <p class="card-text text-muted small mb-1">{{ recipe.category }}</p>
                        <p class="card-text">{{ recipe.description|truncate(100, True) }}</p>
                        <a href="{{ url_for('main.recipe_detail', recipe_id=recipe.id) }}"
                           class="btn btn-outline-success btn-sm">
                           –°–º–æ—Ç—Ä–µ—Ç—å —Ä–µ—Ü–µ–ø—Ç
                        </a>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
{% else %}
    <div class="alert alert-secondary text-center" role="alert">
        –ü–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ üòî
    </div>
{% endif %}

{% if pagination and pagination.pages > 1 %}
<nav aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º">
  <ul class="pagination justify-content-center mt-4">
    {% if pagination.has_prev %}
      <li class="page-item">
        <a class="page-link" href="{{ url_for('main.index', page=pagination.prev_num, q=q, category=category) }}">–ù–∞–∑–∞–¥</a>
      </li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">–ù–∞–∑–∞–¥</span></li>
    {% endif %}

    {% for p in pagination.iter_pages(left_edge=1, right_edge=1, left_current=2, right_current=2) %}
      {% if p %}
        {% if p == pagination.page %}
          <li class="page-item active"><span class="page-link">{{ p }}</span></li>
        {% else %}
          <li class="page-item"><a class="page-link" href="{{ url_for('main.index', page=p, q=q, category=category) }}">{{ p }}</a></li>
        {% endif %}
      {% else %}
        <li class="page-item disabled"><span class="page-link">‚Ä¶</span></li>
      {% endif %}
    {% endfor %}

    {% if pagination.has_next %}
      <li class="page-item">
        <a class="page-link" href="{{ url_for('main.index', page=pagination.next_num, q=q, category=category) }}">–í–ø–µ—Ä—ë–¥</a>
      </li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">–í–ø–µ—Ä—ë–¥</span></li>
    {% endif %}
  </ul>
</nav>
{% endif %}
{% endblock %}
